---
layout:     post                    
title:      计算机网络学习        
subtitle:    组播路由协议分析
date:       2019-12-19             
author:     BY shahur                     
catalog: true                       
tags:                              
    - 计算机网络
    - 组播
---
# 组播路由协议分析
## 通信场景
组播数据包被限制在广播域中  
一旦有设备发送国博数据，广播域内所有设备都会收到这个数据包，并消耗资源处理，大量广播数据包将消耗网络带宽及设备资源。  
组播路由协议适合“一对多”模型，只有加到特定组播组的成员，才会收到组播数据，存在多个组播组成员时，源无需发送多个数据，只需要发送一个数据，再有组播网络设备（路由器）进行拷贝转发。
## 优势 
提高了效率，优化性能，分布式应用。
## 劣势
基于udp协议，采用尽力而为的传输方式  
没有拥塞避免机制  
可能出现报文重复现象  
可能出现报文失序现象  
## 应用
多媒体直播  
不知道接受者地址  
数据仓库  
一对多数据模型应用
## 服务模型
### 第一层：
source
组播源向特定组播组发送组播数据，不关心组成员的所在。
### 第二层：
组播路由协议（pim等）
构成了组播分发树，是组播流量的转发路径

### 第三层：
组成员管理协议（igmp）
最后一跳路由器和组成员组成。
## 术语
组播源：组播流量的发送者
组播接受者：组播组成员
组播组：一个使用组播ip地址表示的群组
组播路由器：
支持组播、运行组播协议的网络设备（特殊型号交换机、防火墙也能够支持组播）。
### 第一跳路由器：直连source的组播路由器
### 最后一条路由器：
直连组成员的组播路由器
## 组播ip地址详解：
d类地址（224.0.0.0/4）被用于组播。  
组播地址代表一个接受者的集合  
IANA对D类地址坐了进一步定义：  
224.0.0.0-224.0.0.255 永久组地址，该类组播地址只能在本地链路工作，IANA将这些地址用于特殊用途：  
  224.0.0.1 所有组播节点  
  224.0.0.2 所有组播路由器  
  224.0.0.5 OSPF路由器组播地址  
  224.0.0.9 ripv2路由器  
  224.0.0.13 所有PIM路由器  
224.0.1.-238.255.255.255：用户组地址  
232.0.0.0-232.255.255.255：SSM组地址  
239.0.0.0-239.255.255.255：本地管理组地址  
## 组播IP地址到物理地址的映射
设组播ip地址为  
 1110|01100|001010000001111000100001  
固定位|抛弃位|后23位一一映射  
组播物理地址：  
（00000001|00000000|01011110|0）...  
括号内为固定位，后面32位与ip地址一一映射  
组播mac第一个8位组的最后一位恒为1    
单播mac第一个8位组的最后一位恒为0    
由于ip有5位抛弃。所以组播ip与mac对应关系为32:1  
## 组播路由协议主要功能：
* 在接受组播报文时，判断该报文是否在正确的接口上到达，从而确保组播数据转发无环路出现。  
* 在网络中建立一颗组播分发树
* 组播分发树体现在每一台组播路由器上便是（S，G）或（*，G）的组播转发表项。
## 组播路由表项
###（S，G）
路由表项知道组播源s的位置，主要用于PIM路由器建立SPT。对于PIM-DM和PIM-SM适用。
### （*，G）：
路由表项只知道组播G的存在，主要用于在PIM路由器建立RPT。对于PIM-SM和双向PIM网络适用。
### 转发规则：
如果PIM路由器同时存在两种路由表项。当收到原地址为S，组地址为G的组播报文，且通过RPF（环路检查）的情况下：  
* 如果存在（S，G）路由表项，由其进行转发。  
* 只存在（*，G）路由表项，由其创建（S，G）路由表项，再进行指导转发。  
组播路由表项查询命令：show igmp routing-table   



